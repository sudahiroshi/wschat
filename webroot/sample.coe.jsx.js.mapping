{"version":3,"file":"sample.coe.jsx.js","sources":["lib/built-in.jsx","sample.coe.jsx","lib/js/js.jsx","lib/js/js/web.jsx","nylon.client.jsx","nylon.coe.jsx"],"names":["_Main","main","args","nl","co","mes","message","data","on","msg","onconnect","emit","id","document","getElementById","createElement","tag","EventInit","bubbles","cancelable","CustomEventInit","detail","MutationObserverInit","childList","attributes","characterData","subtree","attributeOldValue","characterDataOldValue","attributeFilter","UIEventInit","view","FocusEventInit","relatedTarget","MouseEventInit","screenX","screenY","clientX","clientY","ctrlKey","shiftKey","altKey","metaKey","button","buttons","region","WheelEventInit","deltaX","deltaY","deltaZ","deltaMode","KeyboardEventInit","key","location","repeat","charCode","keyCode","which","CompositionEventInit","ProgressEventInit","lengthComputable","loaded","total","XMLHttpRequestOptions","anon","ScrollOptions","behavior","ScrollOptionsHorizontal","x","ScrollOptionsVertical","y","BoxQuadOptions","box","relativeTo","ConvertCoordinateOptions","fromBox","toBox","TrackEventInit","track","PopStateEventInit","state","HashChangeEventInit","oldURL","newURL","PageTransitionEventInit","persisted","ErrorEventInit","filename","lineno","column","DragEventInit","dataTransfer","CloseEventInit","wasClean","code","reason","StorageEventInit","oldValue","newValue","url","storageArea","MessageEventInit","origin","lastEventId","source","ports","EventSourceInit","withCredentials","IDBObjectStoreParameters","keyPath","autoIncrement","IDBIndexParameters","unique","multiEntry","IDBVersionChangeEventInit","oldVersion","newVersion","NotificationOptions","titleDir","body","bodyDir","iconUrl","DOMPointInit","z","w","SourceInfo","sourceId","kind","label","MediaStreamTrackEventInit","MediaSourceStates","sourceType","width","height","frameRate","aspectRatio","facingMode","volume","CapabilityRange","max","min","supported","AllVideoCapabilities","AllAudioCapabilities","MediaStreamConstraints","video","audio","MediaTrackConstraints","mandatory","_optional","MinMaxConstraint","HitRegionOptions","path","parentID","cursor","control","role","WebGLContextAttributes","alpha","depth","stencil","antialias","premultipliedAlpha","preserveDrawingBuffer","WebGLContextEventInit","statusMessage","DeviceOrientationEventInit","beta","gamma","absolute","DeviceMotionEventInit","acceleration","accelerationIncludingGravity","rotationRate","interval","nylonfunc","func","object","fn","obj","nylon","global","keyword","map","push","params","keys","split","forEach","element","off","arr","i","length","splice","f","g","a","b","coe","ws","onmessage","me","e","parse","index","indexOf","emitfunc","jsondata","stringify","send","onopen","onclose","close","window"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAi/BI;;;;;;;;AAmBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;SC//BEA;;;;AAEYC,uBAAMC;;;;;CAEhBC,EAAG,GAAE,UAAA;CACLC,EAAG,GAAE,QAAS,0BAAT;CAELC,GAAI,GAAE,CAAA,UAAA,IAAA;;EACJC,OAAQ,GAAEC,IAAI,CAAC,GAAO;EAC1B,YAAID;CAFI,CAAA;CAOVH,EAAGK,WAAE,CAAE,QAAQH,GAAV;CACDI,GAAI,GAAE;CAEVL,EAAGM,sBAAS,CAAE,CAAA,UAAA,CAAA;;EACRH,IAAK;EACTA,IAAI,CAAC,GAAO,GAAEE;EACdN,EAAGQ,SAAI,CAAE,kBAAkBJ,IAApB;CAHK,CAAA,CAAF;;;;;;ACiCZ;;;;;;;;;;;;;AC5BaK,kBAAGA;QACqB;EAAA,OAAA;;GAAA;;EAAA;CAAA,EAA5BC,YAASC,eAAc,CAACF,EAAD,CAAK;;;;;AAOxBE,8BAAeF;QACS;EAAA,OAAA;;GAAA;;EAAA;CAAA,EAA5BC,YAASC,eAAc,CAACF,EAAD,CAAK;;;;;AAOxBG,6BAAcC;QACU;EAAA,OAAA;;GAAA;;EAAA;CAAA,EAA5BH,YAASE,cAAa,CAACC,GAAD,CAAM;;;;;SAuIlBC;C,IAGlBC,Q,G;C,IAEAC,W,G;;;;SAyBkBC;CAAAA,mBAAAA,CAAAA;C,IAGlBC,O,G;;;;SA6FkBC;C,IAElBC,U,G;C,IACAC,W,G;C,IACAC,c,G;C,IACAC,Q,G;C,IACAC,kB,G;C,IACAC,sB,G;C,IACAC,gB,G;;;;SAy4BkBC;CAAAA,mBAAAA,CAAAA;C,IAKlBC,K,G;C,IAEAV,O,G;;;;SAKkBW;C,IAElBd,Q,G;C,IACAC,W,G;C,IACAY,K,G;C,IACAV,O,G;C,IACAY,c,G;;;;SAKkBC;CAAAA,qBAAAA,CAAAA;C,IAOlBC,Q,G;C,IAEAC,Q,G;C,IAEAC,Q,G;C,IAEAC,Q,G;C,IAEAC,Q,G;C,IAEAC,S,G;C,IAEAC,O,G;C,IAEAC,Q,G;C,IAEAC,O,G;C,IAEAC,Q,G;C,IAEAX,c,G;C,IAIAY,O,G;;;;SAKkBC;C,IAElB5B,Q,G;C,IACAC,W,G;C,IACAY,K,G;C,IACAV,O,G;C,IACAc,Q,G;C,IACAC,Q,G;C,IACAC,Q,G;C,IACAC,Q,G;C,IACAC,Q,G;C,IACAC,S,G;C,IACAC,O,G;C,IACAC,Q,G;C,IACAC,O,G;C,IACAC,Q,G;C,IACAX,c,G;C,IACAc,O,G;C,IACAC,O,G;C,IACAC,O,G;C,IACAC,U,G;;;;SAKkBC;C,IAElBjC,Q,G;C,IACAC,W,G;C,IACAY,K,G;C,IACAV,O,G;C,IACA+B,I,G;C,IACAC,S,G;C,IACAd,Q,G;C,IACAC,S,G;C,IACAC,O,G;C,IACAC,Q,G;C,IACAY,O,G;C,IACAC,S,G;C,IACAC,Q,G;C,IACAC,M,G;;;;SAKkBC;C,IAElBxC,Q,G;C,IACAC,W,G;C,IACAY,K,G;C,IACAV,O,G;C,IACAd,K,G;;;;SAqDkBoD;CAAAA,mBAAAA,CAAAA;C,IAElBC,iB,G;C,IACAC,O,G;C,IACAC,M,G;;;;SAwFkBC;C,IAElBC,K,G;;;;SA+/BkBC;C,IAElBC,S,G;;;;SAoCkBC;CAAAA,uBAAAA,CAAAA;C,IAElBC,E,G;;;;SAKkBC;CAAAA,uBAAAA,CAAAA;C,IAElBC,E,G;;;;SAyIkBC;C,IAElBC,I,G;C,IACAC,W,G;;;;SAKkBC;C,IAElBC,Q,G;C,IACAC,M,G;;;;SAk3BkBC;CAAAA,mBAAAA,CAAAA;C,IAElBC,M,G;;;;SAkkBkBC;CAAAA,mBAAAA,CAAAA;C,IAElBC,M,G;;;;SAgBkBC;CAAAA,mBAAAA,CAAAA;C,IAElBC,O,G;C,IACAC,O,G;;;;SAekBC;CAAAA,mBAAAA,CAAAA;C,IAElBC,U,G;;;;SAwEkBC;CAAAA,mBAAAA,CAAAA;C,IAGlBhF,Q,G;C,IAEAiF,S,G;C,IAEAC,O,G;C,IAEAC,O,G;;;;SAqLkBC;CAAAA,wBAAAA,CAAAA;C,IAElBC,a,G;;;;SAwlBkBC;CAAAA,mBAAAA,CAAAA;C,IAElBC,S,G;C,IACAC,K,G;C,IACAC,O,G;;;;SAiHkBC;CAAAA,mBAAAA,CAAAA;C,IAElB5C,I,G;C,IACA6C,S,G;C,IACAC,S,G;C,IACAC,I,G;C,IACAC,Y,G;;;;SAmBkBC;CAAAA,mBAAAA,CAAAA;C,IAElB9F,K,G;C,IACA+F,O,G;C,IACAC,Y,G;C,IACAC,O,G;C,IACAC,M,G;;;;SAwKkBC;C,IAElBC,gB,G;;;;SAuBkBC;C,IAElBC,Q,G;C,IACAC,c,G;;;;SAKkBC;C,IAElBC,O,G;C,IACAC,W,G;;;;SAKkBC;CAAAA,mBAAAA,CAAAA;C,IAElBC,W,G;C,IACAC,W,G;;;;SAmSkBC;C,IAElBC,S,G;C,IACAC,K,G;C,IACAC,Q,G;C,IACAxG,I,G;C,IACAyG,Q,G;;;;SA+BkBC;C,IAElBtD,E,G;C,IACAE,E,G;C,IACAqD,E,G;C,IACAC,E,G;;;;SAoOkBC;C,IAElBC,S,G;C,IACAC,K,G;C,IACAC,M,G;;;;SAKkBC;CAAAA,mBAAAA,CAAAA;C,IAElBnD,M,G;;;;SAkCkBoD;C,IAElBC,W,G;C,IACAL,S,G;C,IACAM,M,G;C,IACAC,O,G;C,IACAC,U,G;C,IACAC,Y,G;C,IACAC,W,G;C,IACAC,O,G;;;;SAKkBC;C,IAElBC,I,G;C,IACAC,I,G;C,IACAC,U,G;;;;SAKkBC;C,IAElBX,W,G;C,IACAL,S,G;C,IACAM,M,G;C,IACAC,O,G;C,IACAC,U,G;C,IACAC,Y,G;C,IACAC,W,G;;;;SAKkBO;C,IAElBN,O,G;;;;SAekBO;C,IAElBC,M,G;C,IACAC,M,G;;;;SAKkBC;C,IAElBC,U,G;C,IACAC,U,G;;;;SAYkBC;C,IAElBX,I,G;C,IACAC,I,G;;;;SA+LkBW;C,IAElBC,K,G;C,IACA5I,G,G;C,IACA6I,S,G;C,IACAC,O,G;C,IAEAC,Q,G;C,IAEA3B,M,G;C,IACA4B,K,G;;;;SAwCkBC;C,IAElBC,M,G;C,IACAC,M,G;C,IACAC,Q,G;C,IACAC,U,G;C,IACAC,mB,G;C,IACAC,sB,G;;;;SAi5BkBC;CAAAA,mBAAAA,CAAAA;C,I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","sourcesContent":[null,"import \"js.jsx\";\nimport \"js/web.jsx\";\nimport \"nylon.client.jsx\";\nimport \"nylon.coe.jsx\";\n\nclass _Main {\n\n  static function main( args: string[] ): void {\n//    var connectid = dom.id( \"connectId\" );\n    var nl = new nylon();\n    var co = new coe( 'ws://localhost:8000/chat' );\n\n    var mes = function( data: Map.<variant> ): void {\n      var message = data[\"mes\"] as string;\n      log message;\n//      dom.id( 'receiveMsg' ).append( message );\n//      dom.id( 'receiveMsg' ).appendChild( Document.createTextNode( message ) );\n//      dom.id( 'receiveMsg' ).appendChild( dom.createElement( 'br' ) );\n    };\n    nl.on( \"chat\", mes );\n    var msg = \"test\";\n\n    co.onconnect( function( e:Event ) : void {\n      var data = {}: Map.<variant>;\n      data[\"mes\"] = msg;\n      nl.emit( \"broadcast|chat\", data );\n    });\n  }\n}\n",null,null,"import \"js.jsx\";\n\nclass nylonfunc {\n\tvar fn: function( :Map.<variant> ): void;\n\tvar obj: nylon;\n\tfunction constructor( func: function( :Map.<variant> ): void, object: nylon ) {\n\t\tthis.fn = func;\n\t\tthis.obj = object;\n\t}\n}\n\nclass nylon {\n\tstatic var map = js.global[\"map\"] as Map.<Array.<nylonfunc>>;\n\n\tfunction constructor() {\n\t\tif( js.global[\"map\"] == null )\tjs.global[\"map\"] = {}: Map.<Array.<nylonfunc>>;\n\t}\n\tfunction on( keyword: string, fn: function( :Map.<variant> ): void ): void {\n\t\tif( nylon.map[ keyword ] == null ){\n\t\t\tlog \"map - keyword is null\";\n\t\t\tnylon.map[ keyword ] = [ new nylonfunc( fn, this ) ];\n\t\t} else {\n\t\t\tnylon.map[ keyword ].push( new nylonfunc( fn, this ) );\n\t\t}\n\t}\n\tfunction emit( keyword: string, params: Map.<variant> ): void {\n\t\tlog nylon.map[keyword];\n\t\tvar keys = keyword.split( \"|\" );\n\t\tthis.emit( keys, params );\n\t}\n\tfunction emit( keys: Array.<string>, params: Map.<variant> ): void {\n\t\tif( nylon.map[\"keywords\"] == null)\tparams[\"keywords\"] = keys;\n\t\tkeys.forEach( function( key: Nullable.<string> ): void {\n\t\t\tif( nylon.map[key] == null ) {\n\t\t\t\tlog  \"Invarid keyword!\";\n\t\t\t} else {\n\t\t\t\tnylon.map[key].forEach( function( element: nylonfunc ): void {\n\t\t\t\t\tif( element.obj != this ) {\n\t\t\t\t\t\t//Timer.setTimeout( ()-> { element.fn(params); }, 0 );\n\t\t\t\t\t\telement.fn( params );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\tfunction off( keyword: string, fn: function( :Map.<variant> ): void ): void {\n\t\tif( nylon.map[ keyword ] == null ){\n\t\t\tlog \"map - keyword is null\";\n\t\t} else {\n\t\t\tvar arr = nylon.map[keyword];\n\t\t\tfor( var i=arr.length-1; i>=0; i-- ){\n\t\t\t\tlog i;\n\t\t\t\tif( arr[i].obj == this && arr[i].fn == fn ){\n\t\t\t\t\tarr.splice( i, 1 );\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( nylon.map[ keyword ].length == 0 )\tnylon.map[ keyword ] = null;\n\t\t}\n\t}\n}\n\n\nclass _Main {\n\tstatic function main( args: string[] ): void {\n\t\tvar f = function( x: Map.<variant> ): void {\n\t\t\tlog \"f was executed\";\n\t\t};\n\t\tvar g = function( x: Map.<variant> ): void {\n\t\t\tlog \"g was executed\";\n\t\t};\n\n\t\tvar a = new nylon();\n\t\tlog \"check A\";\n\t\ta.on( \"test\", f );\n\t\ta.on( \"test2\", f );\n\t\tlog nylon.map;\t// for debug;\n\t\tlog \"check B\";\n\t\ta.on( \"test\", g );\n\t\tlog nylon.map;\t// for debug;\n\t\ta.emit(\"test\", {}:Map.<variant>);\t// not execute\n\n\t\tvar b = new nylon();\n\t\tlog \"check C\";\n\t\tb.emit(\"test\", null);\t// execute\n\t\tb.emit(\"test2\", null);\t// execute\n\t\ta.off( \"test\", f );\n\t\tlog \"check D\";\n\t\tlog nylon.map;\n\t\tlog \"check E\";\n\t\tb.emit(\"test|test2\", null);\n\t\tlog nylon.map;\n\t}\n}\n","import \"js.jsx\";\nimport \"js/web.jsx\";\nimport \"nylon.client.jsx\";\n\nclass coe {\n  var ws : WebSocket;\n  var nl : nylon;\n\n  function constructor( url : string ) {\n    this.ws = new WebSocket( url );\n    this.nl = new nylon();\n\n    this.ws.onmessage = function( e : Event ) : void {\n      var me = e as MessageEvent;\n      var data = JSON.parse( me.data as string ) as Map.<variant>;\n      var keys = data[\"keywords\"] as Array.<string>;\n      var index = keys.indexOf( 'broadcast' );\n      if( index != -1 ) {\n        keys.splice( index, 1 );\n      }\n      this.nl.emit( keys, data );\n    };\n\n    var emitfunc = function( params: Map.<variant> ): void {\n      var jsondata = JSON.stringify( params );\n      this.ws.send( jsondata );\n    };\n\n    this.nl.on( \"broadcast\", emitfunc );\n    this.nl.on( \"server\", emitfunc );\n  }\n\n  function onconnect( fn: function( :Event ): void ) : void {\n    if( this.ws != null ) {\n      this.ws.onopen = fn;\n    }\n  }\n\n  function onclose( fn: function( :Event ) : void ) : void {\n    this.ws.onclose = fn;\n  }\n\n  function close() : void {\n    this.ws.close();\n  }\n}\n"]}